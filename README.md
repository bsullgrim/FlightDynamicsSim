# Flight Dynamics Project 5 - MATLAB Code

## Overview
This MATLAB script simulates the flight dynamics of an aircraft by modeling its longitudinal and lateral dynamics. The goal is to simulate the aircraft's response to control inputs and analyze key flight parameters such as velocity, angle of attack, pitch rate, roll rate, etc. The code takes into account aircraft properties such as mass, inertia, and aerodynamic coefficients, which influence the motion and control of the aircraft.

The aircraft's dynamics are modeled using state-space representation, a powerful mathematical method for representing dynamic systems in terms of matrices. By linearizing the system, the code allows for the simulation of the aircraft's behavior in response to control inputs over time, helping to understand how the aircraft will perform under various conditions.

### Key Concepts

#### Flight Dynamics
Flight dynamics is the study of how an aircraft responds to different forces and moments acting on it during flight. The primary forces involved are:
- **Lift**: Generated by the wings, opposing gravity.
- **Thrust**: Generated by the engines, propelling the aircraft forward.
- **Drag**: Air resistance that opposes the aircraft’s forward motion.
- **Weight**: The gravitational force pulling the aircraft downward.

Flight dynamics can be broken down into:
- **Longitudinal dynamics**: Pertains to motion along the aircraft’s body axis, primarily involving pitch control, speed, and altitude.
- **Lateral dynamics**: Involves roll and yaw control, which affect the aircraft's orientation around the body axis.

#### State-Space Representation
State-space representation is used to model the dynamic behavior of systems. In this context, it is used to represent the equations of motion for an aircraft. The system is described by a set of first-order differential equations, which are linearized to obtain matrices that describe the aircraft's response to inputs.

The state-space matrices are:
- **A (state matrix)**: Describes the system’s internal dynamics. It relates the current state of the system to the rate of change of the state.
- **B (input matrix)**: Describes how the control inputs (e.g., control surface deflections) affect the system's states.
- **C (output matrix)**: Relates the system states to the measured outputs.
- **D (feedthrough matrix)**: Represents direct relationships between the inputs and the outputs (though in many systems, this matrix is often zero).

In this MATLAB code, these matrices are used to model and simulate both the longitudinal and lateral dynamics of the aircraft.

#### Aerodynamic Coefficients
Aerodynamic coefficients quantify the relationship between aerodynamic forces and control surface deflections. These coefficients are typically derived from wind tunnel tests or computational fluid dynamics simulations and are crucial for aircraft stability and control analysis.

In the code, the following aerodynamic coefficients are defined:
- **Lift coefficient (CL)**: Describes the lift produced by the wings as a function of the angle of attack, pitch rate, and control surface deflections.
- **Drag coefficient (CD)**: Describes the drag force experienced by the aircraft due to its motion through the air.
- **Side force coefficient (CY)**: Describes the side forces that arise due to roll and yaw motions.
- **Moment coefficients (Cl, Cm, Cn)**: These describe the moments around the roll, pitch, and yaw axes, respectively.

These coefficients are used to calculate the forces and moments acting on the aircraft, which are then incorporated into the system's equations of motion.

### Code Breakdown

#### 1. **Initialization**
The code begins by setting up the initial conditions for the aircraft's flight state:
- `Vt0`: Initial true airspeed in feet per second.
- `a0, b0, p0, q0, r0, phi0, theta0, psi0`: Initial values for angle of attack (`alpha`), sideslip angle (`beta`), roll rate (`p`), pitch rate (`q`), yaw rate (`r`), roll angle (`phi`), pitch angle (`theta`), and heading (`psi`).

The inertia matrix `I` is also initialized based on the aircraft's mass and moments of inertia along with the cross-inertia terms.

#### 2. **Inertia and Mass Properties**
The aircraft's inertia matrix, denoted as `I`, is defined using the following terms:
- `Ixx, Iyy, Izz`: The moments of inertia about the body axes.
- `Ixz`: The product of inertia term, describing the coupling between pitch and yaw axes.
- `Ixy, Iyz`: Cross-inertia terms, which are typically zero in simpler models.
The inverse of the inertia matrix (`Iinv`) is calculated for later use in the simulation.

#### 3. **Aerodynamic Coefficients**
The code defines several aerodynamic coefficients for various flight conditions:
- **Lift (CL)**, **Drag (CD)**, and **Side Force (CY)** coefficients are provided as functions of flight conditions such as angle of attack, pitch rate, and control surface deflections.
- **Moment coefficients (Cl, Cm, Cn)** describe the aircraft's pitching, rolling, and yawing moments based on control surface deflections (elevator, ailerons, rudder) and the aerodynamic state.

These coefficients are used throughout the simulation to calculate the forces and moments affecting the aircraft.

#### 4. **Control Inputs**
The code allows the specification of control surface deflections to simulate how the aircraft will respond to changes in control inputs:
- **Elevator deflection (`dei`, `def`)**: Affects the pitch motion of the aircraft.
- **Aileron deflection (`dai`, `daf`)**: Affects the roll motion of the aircraft.
- **Rudder deflection (`dri`, `drf`)**: Affects the yaw motion of the aircraft.

These values can be adjusted to simulate different flight scenarios, including changes in the aircraft's pitch, roll, and yaw behavior.

#### 5. **Simulation**
The `sim()` function is used to run the simulation in MATLAB. It simulates the aircraft's response to the initial conditions and control inputs over time, using the equations defined in the Simulink model (`FD_5`).

The state-space matrices (A, B, C, D) are then extracted from the Simulink model using the `linmod()` function. This function linearizes the system and generates the matrices that describe the longitudinal (`Alon`, `Blon`, `Clon`, `Dlon`) and lateral (`Alat`, `Blat`, `Clat`, `Dlat`) dynamics.

#### 6. **Dynamic Responses**
After running the simulation, the code generates plots of the key flight parameters over time:
- **True airspeed (`Vt`)** vs. time
- **Angle of attack (`alpha`)** vs. time
- **Sideslip angle (`beta`)** vs. time
- **Roll rate (`p`)** vs. time
- **Pitch rate (`q`)** vs. time
- **Yaw rate (`r`)** vs. time
- **Roll angle (`phi`)** vs. time
- **Pitch angle (`theta`)** vs. time

These plots help visualize how the aircraft’s state evolves during the flight simulation.

#### 7. **System Identification**
After the simulation, the system matrices for both longitudinal and lateral dynamics are examined:
- The **longitudinal system** (`syslon`) and **lateral system** (`syslat`) are defined as state-space models.
- The eigenvalues of the longitudinal system are computed using `eig(Alon)`, and the damping ratios are computed using `damp(syslon)` to assess system stability.

#### 8. **Transfer Function**
Finally, the transfer function for the longitudinal motion is derived using `tf(syslon)`. This allows for further analysis of the system's frequency response and is useful for control system design.

### Requirements
To run this code successfully, you need:
- **MATLAB** with the Simulink toolbox.
- The **FD_5** Simulink model file, which contains the equations for aircraft dynamics.

Ensure that the appropriate Simulink model is available and correctly set up before running the script.

### Usage
1. Modify the initial conditions, inertia properties, and aerodynamic coefficients based on your specific aircraft.
2. Set the desired control surface deflections to simulate different flight conditions.
3. Run the simulation by executing the MATLAB script.
4. The output will be a set of plots showing how the aircraft responds over time, along with the state-space models for longitudinal and lateral dynamics.

### Output
- Plots showing the dynamic responses of the aircraft (velocity, angle of attack, roll rate, etc.).
- The state-space models for longitudinal and lateral dynamics.
- Transfer functions for further system analysis.

### Example Plot Outputs
- **True airspeed (`Vt`) vs. time**: Shows how the aircraft's speed changes during the flight.
- **Angle of attack (`alpha`) vs. time**: Shows the changes in the aircraft's angle of attack, which affects lift and stability.
- **Pitch rate (`q`) vs. time**: Displays how the aircraft's pitch rate changes, which is controlled by the elevator.
- **Roll rate (`p`) and yaw rate (`r`) vs. time**: Show how the roll and yaw motions evolve with time.

### Notes
- The code assumes that the Simulink model `FD_5` is correctly set up with the equations for the aircraft's motion.
- You can modify the control surface deflections and aerodynamic coefficients to simulate different flight scenarios, including turbulence, maneuvers, or other flight conditions.
